<!DOCTYPE html>
<html lang="zh-TW" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GF Motor 內容管理</title>
    
    <!-- 安全檢查腳本 -->
    <script>
        const token = sessionStorage.getItem('gfmotor-admin-token');
        if (!token) {
            alert('您沒有權限存取此頁面，請先登入。');
            window.location.replace('/static/login.html');
        }
    </script>

    <!-- Bootstrap CSS/Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    
    <style>
        body {
            background-color: var(--bs-dark-bg-subtle);
        }
        .main-container {
            display: flex;
            min-height: 100vh;
        }
        .sidebar {
            width: 280px;
            background-color: var(--bs-dark-bg-subtle);
            border-right: 1px solid var(--bs-border-color-translucent);
        }
        .content {
            flex-grow: 1;
            padding: 2rem;
        }
        .nav-link {
            font-size: 1.1rem;
        }
        .nav-link.active {
            font-weight: bold;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- 左側：側邊欄選單 -->
        <div class="sidebar p-3 d-flex flex-column">
            <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-white text-decoration-none">
                <i class="bi bi-gear-wide-connected fs-4 me-2"></i>
                <span class="fs-4">GF Motor 後台</span>
            </a>
            <hr>
            <ul class="nav nav-pills flex-column mb-auto">
                <li class="nav-item">
                    <a href="#bookings" class="nav-link text-white active" data-target="bookings">
                        <i class="bi bi-calendar-check me-2"></i>預約紀錄
                    </a>
                </li>
                <li>
                    <a href="#today-orders" class="nav-link text-white" data-target="today-orders">
                        <i class="bi bi-clock-history me-2"></i>今日訂單
                    </a>
                </li>
                <li>
                    <a href="#portfolio" class="nav-link text-white" data-target="portfolio">
                        <i class="bi bi-collection-fill me-2"></i>作品集管理
                    </a>
                </li>
                <li>
                    <a href="#members" class="nav-link text-white" data-target="members">
                        <i class="bi bi-people-fill me-2"></i>會員管理
                    </a>
                </li>
            </ul>
            <hr>
            <div>
                <a href="/static/login.html" class="d-flex align-items-center text-white text-decoration-none" id="logoutBtn">
                    <i class="bi bi-box-arrow-right me-2"></i>
                    <strong>登出</strong>
                </a>
            </div>
        </div>

        <!-- 右側：主要內容區塊 -->
        <div class="content">
            <!-- 預約紀錄區塊 -->
            <div id="content-bookings" class="content-section active">
                <h3>預約總覽</h3>
                <p>此處將顯示所有客戶的預約紀錄。</p>
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>預約單號</th>
                                <th>預約時間</th>
                                <th>客戶名稱</th>
                                <th>車種</th>
                                <th>服務類別</th>
                                <th>狀態</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- 預約資料將動態載入於此 -->
                            <tr><td colspan="6" class="text-center text-muted">尚未載入預約資料...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- 今日訂單區塊 -->
            <div id="content-today-orders" class="content-section">
                <h3>今日訂單</h3>
                <p>此處將顯示今天的訂單或預約。</p>
            </div>

            <!-- 作品集管理區塊 -->
            <div id="content-portfolio" class="content-section">
                <!-- (您原本的建立作品集功能被移到這裡) -->
                <div class="row g-4 justify-content-center">
                    <div class="col-lg-7">
                        <div class="card border-secondary">
                            <div class="card-header bg-dark text-white">
                                <h5 class="mb-0"><i class="bi bi-pencil-square me-2"></i>建立/管理作品集</h5>
                            </div>
                            <div class="card-body">
                                <form id="uploadForm">
                                    <div class="mb-3"><label for="postCategory" class="form-label">發佈到</label><select class="form-select" id="postCategory"><option>GF Motor 作品集</option></select></div>
                                    <div class="mb-3 p-3 border border-secondary-subtle rounded bg-dark-subtle"><label for="uploadImage" class="form-label fw-bold">作品照片</label><p class="text-muted small">分享一張最能代表您作品的相片。</p><input type="file" class="form-control" id="uploadImage" accept="image/*" required></div>
                                    <div class="mb-3"><label for="postTitle" class="form-label fw-bold">標題</label><input type="text" class="form-control" id="postTitle" placeholder="例如：哈雷經典款全車改造" required></div>
                                    <div class="mb-3"><label for="postDescription" class="form-label fw-bold">內文</label><textarea class="form-control" id="postDescription" rows="5" placeholder="輸入關於此作品的詳細描述..."></textarea></div>
                                    <div class="d-grid"><button type="button" class="btn btn-primary btn-lg" onclick="uploadPost()"><i class="bi bi-arrow-up-circle-fill me-2"></i>發佈作品</button></div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-5">
                        <div class="card border-secondary" style="position: sticky; top: 1.5rem;">
                            <div class="card-header text-muted small">網站作品集預覽</div>
                            <div class="card-body p-0">
                                <div class="d-flex align-items-center justify-content-center" style="min-height: 300px; background-color: var(--bs-secondary-bg);"><img id="imgPreview" src="" class="d-none" style="max-width: 100%; object-fit: cover;"><span id="placeholderText" class="text-muted">尚未選擇圖片</span></div>
                                <div class="p-3"><h5 id="previewTitle" class="card-title">(標題將顯示於此)</h5><p id="previewText" class="card-text text-body-secondary" style="white-space: pre-wrap;">(內文將顯示於此...)</p></div>
                                <div class="card-footer bg-transparent border-top-secondary d-flex justify-content-around text-muted small p-2"><span><i class="bi bi-heart"></i> 讚</span><span><i class="bi bi-chat"></i> 留言</span><span><i class="bi bi-share"></i> 分享</span></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 會員管理區塊 -->
            <div id="content-members" class="content-section">
                <h3>會員管理</h3>
                <p>此處將顯示所有會員的資料。</p>
            </div>
        </div>
    </div>

<script>
    // --- 頁內導覽切換功能 ---
    document.addEventListener('DOMContentLoaded', function() {
        const navLinks = document.querySelectorAll('.sidebar .nav-link');
        const contentSections = document.querySelectorAll('.content-section');

        function showContent(targetId) {
            contentSections.forEach(section => {
                section.classList.remove('active');
            });
            navLinks.forEach(link => {
                link.classList.remove('active');
            });

            const targetSection = document.getElementById('content-' + targetId);
            const targetLink = document.querySelector(`.nav-link[data-target="${targetId}"]`);
            
            if(targetSection) targetSection.classList.add('active');
            if(targetLink) targetLink.classList.add('active');
        }

        navLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('data-target');
                showContent(targetId);
                window.location.hash = this.getAttribute('href'); // 更新網址 hash
            });
        });

        // 檢查網址 hash 來決定預設顯示哪個區塊
        const hash = window.location.hash.substring(1);
        if (hash) {
            showContent(hash);
        }

        // 登出按鈕
        document.getElementById('logoutBtn').addEventListener('click', function(e) {
            e.preventDefault();
            sessionStorage.removeItem('gfmotor-admin-token');
            alert('您已成功登出。');
            window.location.href = '/static/login.html';
        });
    });

    // --- 您原本的預覽功能 ---
    const uploadImageInput = document.getElementById('uploadImage');
    const imgPreview = document.getElementById('imgPreview');
    const placeholderText = document.getElementById('placeholderText');
    uploadImageInput.addEventListener('change', function(e){ if(e.target.files[0]){ const reader = new FileReader(); reader.onload = function(event){ imgPreview.src = event.target.result; imgPreview.classList.remove('d-none'); placeholderText.classList.add('d-none'); }; reader.readAsDataURL(e.target.files[0]); } });
    const titleInput = document.getElementById('postTitle');
    const previewTitle = document.getElementById('previewTitle');
    titleInput.addEventListener('input', function(){ previewTitle.innerText = this.value || "(標題將顯示於此)"; });
    const descInput = document.getElementById('postDescription');
    const previewText = document.getElementById('previewText');
    descInput.addEventListener('input', function(){ previewText.innerText = this.value || "(內文將顯示於此...)"; });
    function uploadPost() {
        const imageFile = uploadImageInput.files[0];
        const title = titleInput.value;
        const category = document.getElementById('postCategory').value;
        const description = descInput.value;
        if (!imageFile || !title) { alert("請務必填寫標題並選擇一張圖片！"); return; }
        alert(`準備發佈！\n標題: ${title}\n分類: ${category}`);
        const formData = new FormData();
        formData.append('title', title);
        formData.append('category', category);
        formData.append('file', imageFile);
        // 未來可在此處接上 fetch('/admin/portfolio/upload', ...)
    }
</script>
</body>
</html>